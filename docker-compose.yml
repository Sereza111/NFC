version: '3.8'

services:
  nfc-app:
    # Используем готовый образ из GitHub Container Registry
    # После первого push образ будет доступен автоматически
    image: ghcr.io/sereza111/nfc:latest
    container_name: nfc-site
    pull_policy: always
    network_mode: host
    environment:
      - NODE_ENV=production
      - PORT=10002
      - DB_HOST=eskopeboyed.beget.app
      - DB_PORT=3306
      - DB_USER=nfc
      - DB_PASSWORD=w%eJzfsAiGj3
      - DB_NAME=nfc
      - TELEGRAM_BOT_TOKEN=8298634817:AAGvgd7K3U3RoPz-2SQlqzck-kUVT92DitY
      - TELEGRAM_CHAT_ID=7121428208
      - YOKASSA_SHOP_ID=1193300
      - YOKASSA_SECRET_KEY=live_kncdpR_fVgBHaBvULcl5HDJmb-Hf5ihnzHJwX4OTDqY
      - SITE_URL=https://nfc-vl.ru
      - RUSSIAN_POST_TOKEN=Jb2XiiReaTSgDUBHr1f59HosaXhFjF31
      - RUSSIAN_POST_LOGIN=seregaboj619@gmail.com
      - RUSSIAN_POST_PASSWORD=Sereza_Bojkenco11
      - DADATA_API_KEY=15c5a4e1d5b23f81f87ce3a68fd19ca7dd1452e5
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:10002/api/health"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 60s
    volumes:
      - ./data:/app/data
